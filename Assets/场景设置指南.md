# 连连看游戏 Unity 场景设置指南

## 一、创建游戏管理器 GameObject

### 1. 创建主游戏管理器
- 在 Hierarchy 面板中右键 → Create Empty
- 重命名为 `GameManager`
- 选中 `GameManager`，在 Inspector 面板点击 `Add Component`
- 搜索并添加 `LinkGameManager` 脚本

### 2. 创建网格管理器
- 在 Hierarchy 中右键 → Create Empty
- 重命名为 `GridManager`
- 选中 `GridManager`，添加 `GridManager` 脚本组件
- **重要**：将 `GridManager` 拖拽到 `GameManager` 的 Inspector 中 `LinkGameManager` 组件的 `Grid Manager` 字段

### 3. 创建方向选择器
- 在 Hierarchy 中右键 → Create Empty
- 重命名为 `DirectionSelector`
- 选中 `DirectionSelector`，添加 `DirectionSelector` 脚本组件
- 将 `DirectionSelector` 拖拽到 `GameManager` 的 Inspector 中 `LinkGameManager` 组件的 `Direction Selector` 字段

---

## 二、创建 UI Canvas（用于显示游戏界面）

### 1. 创建 Canvas
- 在 Hierarchy 中右键 → UI → Canvas
- 这会自动创建 Canvas、EventSystem 和 GraphicRaycaster

### 2. 创建网格容器（用于显示游戏网格）
- 在 Canvas 下右键 → UI → Empty（或 GameObject → Create Empty）
- 重命名为 `GridContainer`
- 选中 `GridContainer`，添加组件：
  - `Rect Transform`（自动添加）
  - `Grid Layout Group`（Add Component → Layout → Grid Layout Group）
- 配置 Grid Layout Group：
  - Cell Size: X=80, Y=80（根据你的需求调整）
  - Spacing: X=5, Y=5
  - Start Corner: Upper Left
  - Start Axis: Horizontal
  - Child Alignment: Upper Left
  - Constraint: Fixed Column Count = 8（8x8网格）

### 3. 创建计分显示
- 在 Canvas 下右键 → UI → Text - TextMeshPro（或 Text - Legacy）
- 重命名为 `ScoreText`
- 设置位置（例如：左上角）
- 设置文本内容为 "分数: 0"
- 将 `ScoreText` 拖拽到 `GameManager` 的 Inspector 中 `LinkGameManager` 组件的 `Score Text` 字段

### 4. 创建游戏结束提示（可选）
- 在 Canvas 下右键 → UI → Text - TextMeshPro
- 重命名为 `GameOverText`
- 设置位置（例如：屏幕中央）
- 初始设置为隐藏（取消勾选 GameObject 的激活状态）
- 将 `GameOverText` 拖拽到 `GameManager` 的 Inspector 中 `LinkGameManager` 组件的 `Game Over Text` 字段

---

## 三、创建方向选择 UI 面板

### 1. 创建方向选择面板
- 在 Canvas 下右键 → UI → Panel
- 重命名为 `DirectionPanel`
- 设置背景颜色为半透明（Alpha 约 128）
- 初始设置为隐藏（取消勾选激活状态）

### 2. 创建方向按钮
在 `DirectionPanel` 下创建 4 个按钮：

**上方向按钮：**
- 在 `DirectionPanel` 下右键 → UI → Button - TextMeshPro
- 重命名为 `UpButton`
- 设置按钮文本为 "↑" 或 "上"
- 将 `UpButton` 拖拽到 `DirectionSelector` 的 Inspector 中 `Direction Selector` 组件的 `Up Button` 字段

**下方向按钮：**
- 创建 `DownButton`，文本为 "↓" 或 "下"
- 拖拽到 `Down Button` 字段

**左方向按钮：**
- 创建 `LeftButton`，文本为 "←" 或 "左"
- 拖拽到 `Left Button` 字段

**右方向按钮：**
- 创建 `RightButton`，文本为 "→" 或 "右"
- 拖拽到 `Right Button` 字段

### 3. 配置 DirectionSelector
- 选中 `DirectionSelector` GameObject
- 在 Inspector 中，将 `DirectionPanel` 拖拽到 `Panel` 字段

---

## 四、创建 Tile 预制体

### 1. 创建 Tile GameObject
- 在 Hierarchy 中右键 → UI → Button - TextMeshPro（或 Image）
- 重命名为 `Tile`
- 选中 `Tile`，添加 `Tile` 脚本组件

### 2. 配置 Tile 组件
- 在 Inspector 中找到 `Tile` 脚本组件
- 需要配置以下字段：
  - **Icon Image**: 拖拽 Tile 的 Image 组件（或 Button 的 Image 子对象）
  - **Tile Button**: 拖拽 Tile 的 Button 组件
  - **Selected Effect**: （可选）创建一个子对象作为选中效果，拖拽到这里

### 3. 保存为预制体
- 将 `Tile` 从 Hierarchy 拖拽到 Project 面板的某个文件夹（例如：Assets/Prefabs）
- 这会创建一个预制体
- 删除 Hierarchy 中的 `Tile`（保留预制体即可）

### 4. 配置 GridManager
- 选中 `GridManager` GameObject
- 在 Inspector 中 `GridManager` 组件：
  - **Tile Prefab**: 拖拽刚才创建的 `Tile` 预制体
  - **Grid Container**: 拖拽 Hierarchy 中的 `GridContainer`
  - **Element Sprites**: 点击数组的 "+" 号，添加多个 Sprite 资源（你的元素图标）
  - **Special Element Sprite**: 拖拽一个特殊的 Sprite（用于特殊元素）
  - **Special Element Chance**: 设置为 0.1（10% 概率生成特殊元素）
  - **Grid Width**: 8
  - **Grid Height**: 8

---

## 五、准备 Sprite 资源

### 1. 导入图标资源
- 将你的元素图标图片导入到 Unity（拖拽到 Project 面板）
- 确保图片的 Texture Type 设置为 `Sprite (2D and UI)`
- 点击 Apply

### 2. 配置 GridManager 的元素数组
- 选中 `GridManager`
- 在 `Element Sprites` 数组中，添加至少 16 个不同的 Sprite（8x8网格需要32对元素，所以至少需要16种不同的图标）

---

## 六、最终检查清单

### GameManager (LinkGameManager)
- [ ] Grid Manager 已赋值
- [ ] Direction Selector 已赋值
- [ ] Score Text 已赋值
- [ ] Game Over Text 已赋值（可选）

### GridManager
- [ ] Tile Prefab 已赋值
- [ ] Grid Container 已赋值
- [ ] Element Sprites 数组已填充（至少16个）
- [ ] Special Element Sprite 已赋值
- [ ] Grid Width = 8
- [ ] Grid Height = 8

### DirectionSelector
- [ ] Up Button 已赋值
- [ ] Down Button 已赋值
- [ ] Left Button 已赋值
- [ ] Right Button 已赋值
- [ ] Panel 已赋值

### Tile 预制体
- [ ] Icon Image 已赋值
- [ ] Tile Button 已赋值

---

## 七、运行游戏

1. 确保所有引用都已正确配置
2. 点击 Unity 编辑器顶部的 Play 按钮
3. 游戏应该会自动生成 8x8 网格并开始游戏

---

## 常见问题

**Q: 点击 Tile 没有反应？**
A: 检查 Tile 预制体的 Button 组件是否启用，以及 Tile 脚本的 OnTileClicked 事件是否正确注册。

**Q: 网格没有显示？**
A: 检查 GridContainer 的 RectTransform 大小是否正确，以及 GridLayoutGroup 的配置。

**Q: 特殊元素点击后方向选择面板不显示？**
A: 检查 DirectionSelector 的 Panel 引用是否正确，以及面板的初始状态是否为隐藏。

**Q: 编译错误？**
A: 确保所有脚本都已保存，在 Unity 中按 Ctrl+R 刷新资源，等待 Unity 重新编译。
